<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link type="text/css" rel="stylesheet" href="custom.css"/>
        <script src="js/Respond.min.js"></script>
        <script type="text/javascript" src="d3/d3.js"></script>
    <title>Neuroimaging visualization</title>
  </head>
  <body>
      <div class="container-fluid">
        <!-- row 1 HEADER LOGO AND PAGE TITLE SUBTITLE -->
            <header class="row">
                <div class="col-lg-12" class="intro">
                    <h1>Visualizing Human Neuroimaging Data</h1>
                    <h4><strong>Exploring transient networks in the brain using novel neuroimaging techniques</strong></h4>
                </div>               
            </header>
        </div> <!-- Close container -->
            
        <!-- row 2 LANDING PAGE: PROJECT, DATA, ANALYSIS AND VISUALIZATIONS BRIEF INTRO INFO -->      
        <div class="container" style="margin-left:10em">
      <!-- Row of columns -->
            <div class="row" style="background-color:#D0DADD;" id="jumbo">
                <div class="col-sm-3" style="margin-left: 4em">
                    <h3>Project Goals</h3>
                    <p>1: What is the data quality at the subject level?</p>
                    <p>2: Can we detect transient networks in resting state data?</p>
                    <p>"Resting state" refers ro MRI scans where the participant is asked to lie still and awake, and think of nothing in particular.</p>
                    <p>3: Which data-collection method is best? See "Data" for more information on the data collection methods</p>
                    <p><a class="btn btn-default" href="#data_link" role="button">View Results &raquo;</a></p>
                </div>
                <div class="col-sm-3" style="margin-left: 6em">
                    <h3>Data</h3>
                    <p>Multiband EPI is a new method used to collect whole brain volumes in a significantly shorter time frame, and/or finer spatial detail.</p>
                    <p>Here, we collected one high-temporal resolution (1 second, voxel size 2.2<sup>3</sup>mm) and one high-spatial resolution (2 seconds,voxel size 1.5<sup>3</sup>mm) dataset from each participant.</p>
                    <br>
                    <p><a class="btn btn-default" href="#" role="button">View Details &raquo;</a></p>
                </div>
                <div class="col-sm-3" style="margin-left: 6em">
                    <h3>Analysis and Visualizations</h3>
                    <p>Several types of analysis was performed on this data, including network analysis focussing on the default mode, executive control, and salience networks; cluster analysis, and temporal ordering</p>
                    <p>Visualization approaches include network graphs, matrices/heat maps, and time courses (line graphs).</p>
                    <p><a class="btn btn-default" href="#data_link" role="button">View Results &raquo;</a></p>
                </div>
            </div>
        </div><!-- Close Container 2 -->

        <!-- row 3 ANALYSIS AND VISUALIZATIONS -->  
        <div class="container" style="margin-left:10em">
            <div class="row">
              <div class="col-md-3" style="height: 2px; background-color: #ccc; margin-top:80px"></div>
              <h2 class="col-md-5" id="test" style="margin-left: 1.5em; margin-right: 1.5em">Analysis and Visualizations</h2>    
              <div class="col-md-3" style="height: 2px; background-color: #ccc; margin-top:80px"></div>            
            </div>
        </div> <!-- close 3 Header containing -->



        <!-- row 4 INDIVIDUAL and GROUP data subheadings -->
        <div class="container" style="margin-left:10em">
            <div class="row">
                <div class="col-md-5"><h3 style="text-align:center; color: #B8ABA1;">Individual data</h3></div>
                <div class="col-md-5 col-md-offset-1"><h3 style="text-align:center; color: #B8ABA1">Group data</h3></div>
            </div> <!-- close row -->
        </div> <!-- Close Container 4 -->

        <!-- row 5 DATA BUTTONS -->
        <div class="container" style="margin-left:10em">
          <div class="row">

            <!-- Indi Mean z-score -->
            <button class="btn btn-info btn-lg" onclick="$('#mean-z').toggle();" style="margin-left:4em"><img src="images/mean-z.PNG" class="z-score"/><strong>Mean Network Z-Scores</strong><span class="caret" style="margin-left:3em"></span></button>
                <div id="mean-z" style="display: block">

                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Individual data: <span style="color: #898989">Mean Network Z-Scores</span></h4>
                    </div> <!-- close top banner text -->                  

                    <div id="mean-zD3" class="col-md-7"> 
                        <div class="col-sm-3" style="margin-top: 1em; margin-left:3em; margin-bottom:2em"><p style="font-size:16px; color: #898989; margin-top:0.7em; margin-left:0.5em"><strong>Select Dataset</strong></p></div>
                        <div class="col-sm-4" style="margin-top: 1.5em" class="dropdown">
                            <!--<button class="btn btn-default dropdown-toggle" type="button" id="dataList" data-toggle="dropdown"><img src="images/mean-z.PNG" class="selectDataset"/><strong>EPI1</strong><span class="caret" style="margin-left:0.5em"></span></button>-->
                            <p><img src="images/mean-z.PNG" class="selectDataset"/>EPI1
                              <select id="EPI1">
                                <option selected="selected" value="js/mean-z/EPI1_101.json" class="data">Subject 101</option>
                                <option value="js/mean-z/EPI1_102.json" class="data">Subject 102</option>
                                <option value="js/mean-z/EPI1_103.json" class="data">Subject 103</option>
                                <option value="js/mean-z/EPI1_104.json" class="data">Subject 104</option>
                                <option value="js/mean-z/EPI1_105.json" class="data">Subject 105</option>
                                <option value="js/mean-z/EPI1_106.json" class="data">Subject 106</option>
                                <option value="js/mean-z/EPI1_107.json" class="data">Subject 107</option>
                                <option value="js/mean-z/EPI1_108.json" class="data">Subject 108</option>
                                <option value="js/mean-z/EPI1_109.json" class="data">Subject 109</option>
                                <option value="js/mean-z/EPI1_110.json" class="data">Subject 110</option>
                                <option value="js/mean-z/EPI1_111.json" class="data">Subject 111</option>
                                <option value="js/mean-z/EPI1_112.json" class="data">Subject 112</option>
                              </select>
                            </p>  
                        </div><!--end dropdown EPI1-->

                        <div class="col-sm-4" style="margin-top: 1.5em" class="dropdown">
                            <!--<button class="btn btn-default dropdown-toggle" type="button" id="dataList" data-toggle="dropdown"><img src="images/sq_symbol.PNG" class="selectDataset"/><strong>EPI2</strong><span class="caret" style="margin-left:0.5em"></span></button>-->
                            <p><img src="images/sq_symbol.PNG" class="selectDataset"/>EPI2
                              <select id="EPI2">
                                <option selected="selected" value="js/mean-z/EPI2_101.json" class="data">Subject 101</option>
                                <option value="js/mean-z/EPI2_102.json" class="data">Subject 102</option>
                                <option value="js/mean-z/EPI2_103.json" class="data">Subject 103</option>
                                <option value="js/mean-z/EPI2_104.json" class="data">Subject 104</option>
                                <option value="js/mean-z/EPI2_105.json" class="data">Subject 105</option>
                                <option value="js/mean-z/EPI2_106.json" class="data">Subject 106</option>
                                <option value="js/mean-z/EPI2_107.json" class="data">Subject 107</option>
                                <option value="js/mean-z/EPI2_108.json" class="data">Subject 108</option>
                                <option value="js/mean-z/EPI2_109.json" class="data">Subject 109</option>
                                <option value="js/mean-z/EPI2_110.json" class="data">Subject 110</option>
                                <option value="js/mean-z/EPI2_111.json" class="data">Subject 111</option>
                                <option value="js/mean-z/EPI2_112.json" class="data">Subject 112</option>
                              </select>
                            </p>
                        </div><!--end dropdown EPI2-->

                           
                    </div> <!-- end d3 div -->
                    
                    <div class="col-md-4" style="margin-right:5em; margin-top:2em"> <!-- right text-->
                        <p><strong>Project questions 1:</strong></p>
                        <p>What is the data quality at the subject level?</p>
                        <p><strong>Goal:</strong></p>
                        <p>To assess data quality in terms of correlation strength and variance within each network.</p>
                        <p>Higher mean values indicates that the brain regions comprising that network are communicating well with each other.</p>
                        <p>Higher standard deviation values (longer lines) means that there is more variance within the network. This could be due to misplaced network nodes, preprocessing errors, excess motion by that subject, or that the regions comprising the network are genuinly not communicating well with each other.</p>
                        <p><strong>Conclusion:</strong></p>
                        <p>Subjects 105 and 107 had low means (closer to zero) and high standard deviations. Repositioning the nodes did not improve the outcome. Therefore these subjects' data were excluded from Group analysis for both EPI1 and EPI2.</p>
                      </div> <!-- close right-side column for project question, goals, and conclusions -->
                      
                      <!--bottom section -->
                      <div class="row" style="margin-top:35em; margin-left: -0.5em; height: 140px; width:1350px; padding: 5px; background: #D0DADD">
                         
                         <div class="col-sm-2">
                          <p style="color:#354e7f"><strong>Default Mode Network (DMN)</strong></p>
                          <p class="bottomText">Posterior Cingulate Cortex</p>
                          <p class="bottomText">Angular Gyrus</p>
                          <p class="bottomText">Parahippocampal Cortex</p>
                         </div>
                        <div class="col-sm-2">
                          <p style="color:#b81359;"><strong>Salience Network (SN)</strong></p>
                          <p class="bottomText">Amygdala</p>
                          <p class="bottomText">Anterior Insula</p>
                          <p class="bottomText">Temporoparietal Junction</p>
                         </div>
                         <div class="col-sm-3">
                          <p style="color:#139e9e"><strong>Executive Control Network (ECN)</strong></p>
                          <p class="bottomText">Anterior Cingulate Cortex</P>
                          <p class="bottomText">dorsal Posterior Parietal Cortex</p>
                          <p class="bottomText">dorsolateral Prefrontal Cortex</p>
                          <p class="bottomText">Caudate Nucleus</p>
                         </div>

                         <div class="col-sm-2 ">
                          <p><strong>EPI1</strong></p>
                          <p class="bottomText">Temporal resolution: 1 second</p>
                          <p class="bottomText">Spatial resolution: 2.2<sup>3</sup>mm</p>
                         </div>
                         <div class="col-sm-2">
                          <p><strong>EPI2</strong></p>
                          <p class="bottomText">Temporal resolution: 2 seconds</p>
                          <p class="bottomText">Spatial resolution: 1.5<sup>3</sup>mm</p>
                         </div>
                      </div> <!-- close legend text at bottom of means network z-scores page -->
                </div> <!-- close div id="mean-z" -->

            <!-- Gr mean z-score -->
            <button class="btn btn-info btn-lg" onclick="$('#mean-zGr').toggle();" style="margin-left:9em"><img src="images/mean-z.PNG" class="z-score"/><strong>Mean Network Z-Scores</strong><span class="caret" style="margin-left:3em"></span></button>
                <div id="mean-zGr" style="display: none"><!-- enter d3 bit here -->

                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Group data: <span style="color: #898989">Mean Network Z-Scores</span></h4>
                    </div> <!-- close top banner text -->                  

                    <div id="mean-zGrD3" class="col-md-7"> 
                        <div class="col-sm-3" style="margin-top: 2em; margin-left:7em; margin-bottom:2em"><p style="font-size:16px; color: #898989; margin-top:0.7em; margin-left:0.5em"><strong>Chart Key</strong></p></div>
                        <div class="col-sm-2" style="margin-top: 2em" class="dropdown">
                            <button class="btn btn-default dropdown-toggle" type="button" id="dataList" data-toggle="dropdown"><img src="images/mean-z.PNG" class="selectDataset"/><strong>EPI1</strong></span></button>
                        </div><!--end dropdown EPI1-->

                        <div class="col-sm-2" style="margin-top: 2em" class="dropdown">
                            <button class="btn btn-default dropdown-toggle" type="button" id="dataList" data-toggle="dropdown"><img src="images/sq_symbol.PNG" class="selectDataset"/><strong>EPI2</strong></button>
                        </div><!--end dropdown EPI2-->

                        <!-- D3 Mean Group z-score chart goes here-->

                        <!--legend colors-->                        
                        <!--<div class="row" style="margin-left:18em"> 
                         <p style="color:#354e7f; margin-bottom:0em"><strong>Default Mode Network (DMN)</strong></p>
                         <p style="color:#82142f; margin-bottom:0em"><strong>Salience Network (SN)</strong></p>
                         <p style="color:#139e9e"><strong>Executive Control Network (ECN)</strong></p>
                        </div> -->
                        <!-- close legend colors-->
                    </div> <!-- end d3 div -->
                    
                    <div class="col-md-4" style="margin-right:5em; margin-top:2em"> <!-- right text-->
                        <p><strong>Project questions 3:</strong></p>
                        <p>Which data-collection method is the best?</p>
                        <p><strong>Goal:</strong></p>
                        <p>To assess data quality in terms of correlation strength within each network.</p>
                        <p>Higher mean values indicates that the brain regions comprising that network are communicating well with each other.</p>
                        <p>Higher standard deviation values (longer lines) means that there is more variance within the network, and that brain regions
                          comprising the network are not communicating well with each other.</p>
                        <p><strong>Conclusion:</strong></p>
                        <p>While excluding Subjects 105 and 107 due to low means (close to zero) with high standard deviations, the resulting group means and standard deviations suggest that higher temporal resolution (EPI1) is better at capturing connectivity within these networks.</p>
                    </div> <!-- close right-side column for project question, goals, and conclusions -->
                      
                      <!--bottom section -->
                    <div class="row" style="margin-top:35em; margin-left: -0.5em; height: 140px; width:1350px; padding: 5px; background: #D0DADD">
                       <div class="col-sm-2">
                        <p style="color:#354e7f"><strong>Default Mode Network (DMN)</strong></p>
                        <p class="bottomText">Posterior Cingulate Cortex</p>
                        <p class="bottomText">Angular Gyrus</p>
                        <p class="bottomText">Parahippocampal Cortex</p>
                       </div>
                       <div class="col-sm-2">
                        <p style="color:#b81359;"><strong>Salience Network (SN)</strong></p>
                        <p class="bottomText">Amygdala</p>
                        <p class="bottomText">Anterior Insula</p>
                        <p class="bottomText">Temporoparietal Junction</p>
                       </div>
                       <div class="col-sm-3">
                        <p style="color:#139e9e"><strong>Executive Control Network (ECN)</strong></p>
                        <p class="bottomText">Anterior Cingulate Cortex</P>
                        <p class="bottomText">dorsal Posterior Parietal Cortex</p>
                        <p class="bottomText">dorsolateral Prefrontal Cortex</p>
                        <p class="bottomText">Caudate Nucleus</p>
                       </div>
                       <div class="col-sm-2 ">
                        <p><strong>EPI1</strong></p>
                        <p class="bottomText">Temporal resolution: 1 second</p>
                        <p class="bottomText">Spatial resolution: 2.2<sup>3</sup>mm</p>
                       </div>
                       <div class="col-sm-2">
                        <p><strong>EPI2</strong></p>
                        <p class="bottomText">Temporal resolution: 2 seconds</p>
                        <p class="bottomText">Spatial resolution: 1.5<sup>3</sup>mm</p>
                       </div>
                    </div> <!-- close legend text at bottom of means network z-scores page -->
                </div> <!-- close div id="mean-zGR" -->


            <!-- Indi network -->
            <button class="btn btn-info btn-lg" onclick="$('#network').toggle();" style="margin-left:4em"><img src="images/network.PNG" class="network"/><strong>Network Graphs</strong><span class="caret" style="margin-left:6.2em"></span></button>
                <div id="network" style="display: none; float:left">

                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Individual data: <span style="color: #898989">Network Graphs</span></h4>
                    </div> <!-- close top banner text -->                  

                    <!-- enter d3 bit here -->
                </div>

            <!-- Gr Network -->
            <button class="btn btn-info btn-lg" onclick="$('#networkGr').toggle();" style="margin-left:9em"><img src="images/network.PNG" class="network"/><strong>Network Graphs</strong><span class="caret" style="margin-left:6.2em"></span></button>
                <div id="networkGr" style="display: none">

                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Group data: <span style="color: #898989">Network Graphs</span></h4>
                    </div> <!-- close top banner text -->                  

                    <!-- enter d3 bit here -->
                    <div id="networkGrD3" class="col-md-7"> 
                        <div class="col-sm-4" style="margin-top: 1em">
                          <p style="font-size:16px; color: #898989; margin-top:0.7em; margin-left:0.5em"><strong>EPI1 Group Network</strong></p>
                          <p><label for "weight" style="display: inline-block; width: 240px; text-align:left">Connectivity strength:<span id="weight1-value"></span></label><input type="range" min="0" max="1" step="0.01" value="0.3" id="weight1"></p>
                        </div>
                        <div class="col-sm-3"><!--spacer div--></div>

                        <div class="col-sm-4" style="margin-top:1em; margin-bottom:0em">
                          <p style="font-size:16px; color: #898989; margin-top:0.7em; margin-left:0.5em"><strong>EPI2 Group Network</strong></p>
                          <p><label for "weight" style="display: inline-block; width: 240px; text-align:left">Connectivity strength:<span id="weight2-value"></span></label><input type="range" min="0" max="1" step="0.01" value="0.3" id="weight2"></p>
                        </div><!--end network title-->

                        <!-- D3 Mean GROUP NETWORK chart goes here-->

                        <!--legend colors--> <!-- close legend colors-->
                    </div> <!-- end d3 div  #networkGrD3 -->

                    <div class="col-md-4" style="margin-right:0em; margin-top:2em"> <!-- right text-->
                        <p><strong>Project question 3:</strong></p>
                        <p>Which data-collection method is the best?</p>
                        <p><strong>Goal:</strong></p>
                        <p>To assess data quality in terms of correlation strength within each network.</p>
                        <p>One way to do that is to look at the connections between brain regions. The threshold set here is a z-score of 0.3, meaning that correlations between regions of 0.3 and above are shown in this graph. We would expect a superior data collection method will detect more connections within and between networks.</p>
                        <p><strong>Conclusion:</strong></p>
                        <p>While excluding Subjects 105 and 107 due to terrible means (close to zero) and high standard deviations, the resulting group network graphs show that higher temporal resolution (EPI1) is better at detecting connections between brain regions within networks and also between networks.</p>
                    </div> <!-- close right-side column for project question, goals, and conclusions -->
                      
                      <!--bottom section -->
                    <div class="row" style="margin-top:37em; margin-left: -0.5em; height: 150px; width:1350px; padding: 5px; background: #D0DADD">
                       <div class="col-sm-3">
                        <p style="color: #354e7f"><strong>Default Mode Network (DMN)</strong></p>
                        <p class="bottomText">Posterior Cingulate Cortex (PCCx)</p>
                        <p class="bottomText">Angular Gyrus (AngG)</p>
                        <p class="bottomText">Parahippocampal Cortex (ParaHC)</p>
                       </div>
                       <div class="col-sm-2">
                        <p style="color:#b81359" ><strong>Salience Network (SN)</strong></p>
                        <p class="bottomText">Amygdala (AMY)</p>
                        <p class="bottomText">Anterior Insula (AI)</p>
                        <p class="bottomText">Temporoparietal Junction (TPJ)</p>
                       </div>
                       <div class="col-sm-3">
                        <p style="color:#139e9e"><strong>Executive Control Network (ECN)</strong></p>
                        <p class="bottomText">Anterior Cingulate Cortex (ACC)</P>
                        <p class="bottomText">dorsal Posterior Parietal Cortex (dPPCx)</p>
                        <p class="bottomText">dorsolateral Prefrontal Cortex (dlPFCx)</p>
                        <p class="bottomText">Caudate Nucleus (Caud)</p>
                       </div>
                      <div class="col-sm-3">
                        <p><strong>EPI1</strong></p>
                        <p class="bottomText">Temporal resolution: 1 second</p>
                        <p class="bottomText">Spatial resolution: 2.2<sup>3</sup>mm</p>
                        <p><strong>EPI2</strong></p>
                        <p class="bottomText">Temporal resolution: 2 seconds</p>
                        <p class="bottomText">Spatial resolution: 1.5<sup>3</sup>mm</p>
                      </div>
                    </div> <!-- close legend text at bottom of Group networks page -->
                </div> <!-- close div id="networkGrD3" -->  

            <!-- Indi Correlation matrix -->
            <button class="btn btn-info btn-lg" onclick="$('#corrmat').toggle();" style="margin-left:4em"><img src="images/matrix.PNG" class="matrix"/><strong>Correlation Matrices</strong><span class="caret" style="margin-left:4.4em"></span></button>
                <div id="corrmat" style="display: none">

                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Individual data: <span style="color: #898989">Correlation Matrices</span></h4>
                    </div> <!-- close top banner text -->                  

                    <!-- enter d3 bit here -->
                </div>

            <!-- Gr Correlation Matrix -->
            <button class="btn btn-info btn-lg" onclick="$('#corrmatGr').toggle();" style="margin-left:9em"><img src="images/matrix.PNG" class="matrix"/><strong>Correlation Matrices</strong><span class="caret" style="margin-left:4.5em"></span></button>
                <div id="corrmatGr" style="display: none">
                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Group data: <span style="color: #898989">Correlation Matrices</span></h4>
                    </div> <!-- close top banner text -->                  

                <!-- enter d3 bit here -->
                </div>

            <!-- Indi Time Courses -->
            <button class="btn btn-info btn-lg" onclick="$('#tc').toggle();" style="margin-left:4em"><img src="images/lines.PNG" class="lines"/><strong>Time Courses</strong><span class="caret" style="margin-left:7.6em"></span></button>
                <div id="tc" style="display: none">
                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Individual data: <span style="color: #898989">Time Courses</span></h4>
                    </div> <!-- close top banner text -->                  

                    <!-- enter d3 bit here -->
                </div>                    
          </div> <!-- end row -->

          <div class="row"> <!-- new row within container for cluster analysis -->
            
            <!-- Group only: Cluster Analysis -->
            <h4 id="clust-head"><strong>Cluster Analysis:</strong></h4>


            <button class="btn btn-info btn-lg" onclick="$('#networkClust').toggle();" style="margin-left:33.5em"><img src="images/network.PNG" class="network"/><strong>Network Graphs</strong><span class="caret" style="margin-left:6.2em"></span></button>
                <div id="networkClust" style="display: none">

                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Cluster Analysis: <span style="color: #898989">Network Graphs</span></h4>
                    </div> <!-- close top banner text -->                  
                  
                <!-- enter d3 bit here -->
                    <div id="networkClustD3" class="col-md-7"> 
                        <div class="col-sm-4" style="margin-top: 2em"><p style="font-size:16px; color: #898989; margin-top:0.7em; margin-left:0.5em"><strong>EPI1 Cluster 1</strong></p></div>
                        <div class="col-sm-3"><!--spacer div--></div>

                        <div class="col-sm-4" style="margin-top: 2em; margin-bottom: 3em"><p style="font-size:16px; color: #898989; margin-top:0.7em; margin-left:0.5em"><strong>EPI1 Cluster 2</strong></p></div><!--end network title-->

                        <!-- D3 NETWORK CLUSTER chart goes here-->

                        <!--legend colors--> <!-- close legend colors-->
                    </div> <!-- end d3 div  #networkGrD3 -->

                    <div class="col-md-4" style="margin-right:0em; margin-top:4em"> <!-- right text-->
                        <p><strong>Project question 1:</strong></p>
                        <p>Can we detect transient networks in resting state data?</p>
                        <p><strong>Goal and Results:</strong></p>
                        <p>To identify transient networks, or "clusters".</p>
                        <p>Clusters were identified using an unsupervised clustering algorithm (Dirichlet Process Gaussian Mixture Model, or DPGMM for short). First, it found that the EPI1 was best divided into two clusters (also called centroids), or brain states, where as EPI2 only contained one cluster. </p>
                        <p><strong>Conclusion:</strong></p>
                        <p>EPI1 group resting state data comprises two recurring brain states over the course of nine minutes. One state (Cluster 1) consists of a highly connected framework where connectivity is increased between nodes within and between networks. The second brain state (Cluster 2) is much less connected overall. Therefore, we are able to detect transient networks using high temporal resoution.</p>
                    </div> <!-- close right-side column for project question, goals, and conclusions -->
                      
                      <!--bottom section -->
                    <div class="row" style="margin-top:37em; margin-left: -0.5em; height: 120px; width:1350px; padding: 5px; background: #D0DADD">
                       <div class="col-sm-3">
                        <p style="color: #354e7f"><strong>Default Mode Network (DMN)</strong></p>
                        <p class="bottomText">Posterior Cingulate Cortex (PCCx)</p>
                        <p class="bottomText">Angular Gyrus (AngG)</p>
                        <p class="bottomText">Parahippocampal Cortex (ParaHC)</p>
                       </div>
                      <div class="col-sm-3">
                        <p style="color: #b81359"><strong>Salience Network (SN)</strong></p>
                        <p class="bottomText">Amygdala (AMY)</p>
                        <p class="bottomText">Anterior Insula (AI)</p>
                        <p class="bottomText">Temporoparietal Junction (TPJ)</p>
                       </div>
                       <div class="col-sm-3">
                        <p style="color:#139e9e"><strong>Executive Control Network (ECN)</strong></p>
                        <p class="bottomText">Anterior Cingulate Cortex (ACC)</P>
                        <p class="bottomText">dorsal Posterior Parietal Cortex (dPPCx)</p>
                        <p class="bottomText">dorsolateral Prefrontal Cortex (dlPFCx)</p>
                        <p class="bottomText">Caudate Nucleus (Caud)</p>
                       </div>                       
                       <div class="col-sm-2">
                        <p><strong>EPI1</strong></p>
                        <p class="bottomText">Temporal resolution: 1 second</p>
                        <p class="bottomText">Spatial resolution: 2.2<sup>3</sup>mm</p>
                       </div>                       
                    </div> <!-- close legend text at bottom of Group networks page -->
                </div> <!-- close div id="networkClusD3" --> 
                

            <button class="btn btn-info btn-lg" onclick="$('#corrmatClust').toggle();" style="margin-left:33.5em"><img src="images/matrix.PNG" class="matrix"/><strong>Correlation Matrices</strong><span class="caret" style="margin-left:4.5em"></span></button>
                <div id="corrmatClust" style="display: block">

                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Cluster Analysis: <span style="color: #898989">Correlation Matrices</span></h4>
                    </div> <!-- close top banner text -->                  

                <!-- enter d3 bit here -->
                    <div id="corrmatClustD3" class="col-md-7"> 
                        <div class="col-sm-4" style="margin-top: 2em"><p style="font-size:16px; color: #898989; margin-top:0.7em; margin-left:0.5em"><strong>EPI1 Cluster 1</strong></p></div>
                        <div class="col-sm-3"><!--spacer div--></div>

                        <div class="col-sm-4" style="margin-top: 2em"><p style="font-size:16px; color: #898989; margin-top:0.7em; margin-left:0.5em"><strong>EPI1 Cluster 2</strong></p></div><!--end network title-->

                        <!-- D3 CORRMAT CLUSTER (adjacency matrix) chart goes here-->

                    </div> <!-- end d3 div  #corrmatClustD3 -->

                    <div class="col-md-4" style="margin-right:0em; margin-top:4em"> <!-- right text-->
                        <p><strong>Project question 1:</strong></p>
                        <p>Can we detect transient networks in resting state data?</p>
                        <p><strong>Goal and Results:</strong></p>
                        <p>To identify transient networks, or "clusters".</p>
                        <p>Clusters were identified using an unsupervised clustering algorithm <a href="http://scikit-learn.org/stable/modules/mixture.html">(Dirichlet Process Gaussian Mixture Model, or DPGMM for short)</a>. First, it found that the EPI1 was best divided into two clusters (also called centroids), or brain states, where as EPI2 only contained one cluster. </p>
                        <p><strong>Conclusion:</strong></p>
                        <p>EPI1 group resting state data comprises two recurring brain states over the course of nine minutes. One state (Cluster 1) consists of a highly connected framework where connectivity is increased between nodes within and between networks. The second brain state (Cluster 2) is much less connected overall. Therefore, we are able to detect transient networks using high temporal resoution.</p>
                    </div> <!-- close right-side column for project question, goals, and conclusions -->
                      
                      <!--bottom section -->
                    <div class="row" style="margin-top:37em; margin-left: -0.5em; height: 120px; width:1350px; padding: 5px; background: #D0DADD">
                       <div class="col-sm-3">
                        <p style="color: #354e7f"><strong>Default Mode Network (DMN)</strong></p>
                        <p class="bottomText">Posterior Cingulate Cortex (PCCx)</p>
                        <p class="bottomText">Angular Gyrus (AngG)</p>
                        <p class="bottomText">Parahippocampal Cortex (ParaHC)</p>
                       </div>
                       <div class="col-sm-3">
                        <p style="color:#b81359 "><strong>Salience Network (SN)</strong></p>
                        <p class="bottomText">Amygdala (AMY)</p>
                        <p class="bottomText">Anterior Insula (AI)</p>
                        <p class="bottomText">Temporoparietal Junction (TPJ)</p>
                       </div>
                       <div class="col-sm-3">
                        <p style="color:#139e9e"><strong>Executive Control Network (ECN)</strong></p>
                        <p class="bottomText">Anterior Cingulate Cortex (ACC)</P>
                        <p class="bottomText">dorsal Posterior Parietal Cortex (dPPCx)</p>
                        <p class="bottomText">dorsolateral Prefrontal Cortex (dlPFCx)</p>
                        <p class="bottomText">Caudate Nucleus (Caud)</p>
                       </div>
                       <div class="col-sm-2">
                        <p><strong>EPI1</strong></p>
                        <p class="bottomText">Temporal resolution: 1 second</p>
                        <p class="bottomText">Spatial resolution: 2.2<sup>3</sup>mm</p>
                       </div>                       
                    </div> <!-- close legend text at bottom of Group networks page -->
                </div> <!-- close div id="corrmatClust" --> 

            <button class="btn btn-info btn-lg" onclick="$('#tempOrd').toggle();" style="margin-left:33.5em"><img src="images/lines.PNG" class="lines"/><strong>Temporal Ordering</strong><span class="caret" style="margin-left:5.1em"></span></button>
                <div id="tempOrd" style="display: none">

                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Cluster Analysis: <span style="color: #898989">Temporal Ordering</span></h4>
                    </div> <!-- close top banner text -->                  

                <!-- enter d3 bit here -->
                </div>

            <button class="btn btn-info btn-lg" onclick="$('#tempDur').toggle();" style="margin-left:33.5em"><img src="images/lines.PNG" class="lines"/><strong>Temporal Duration</strong><span class="caret" style="margin-left:5.2em"></span></button>
                <div id="tempDur" style="display: none">

                      <!--top banner section -->
                    <div class="row" style="margin-left: -0.5em; height: 50px; width:1350px; background: #E6E6E6">
                      <h4 style="color: #B8ABA1; font-family: Verdana; text-align: left; margin-top: 16px; margin-bottom: 16px; margin-left: 180px">Cluster Analysis: <span style="color: #898989">Temporal Duration</span></h4>
                    </div> <!-- close top banner text -->                  

                <!-- enter d3 bit here -->
                </div>
           </div><!-- Close row   -->
        </div> <!-- Close row 5 DATA Container -->                        
                  


                </div>
            </div>
        </div>   <!-- Close Container -->

    <!-- row # FOOTER --> 
      <hr>           
      <footer class="row">
              <p><small>Maryland Institute and College of Art (MICA): Information Visualization MPS</small></p>
      </footer>
    </div><!-- Close container -->
 
        <!-- Javascript -->
  <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="d3/d3.tip.js"></script> <!-- from http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js -->

    <!--<script type="text/javascript" src="Indi_meanz.js"></script> //Indi meanz D3-->

    <script type="text/javascript">   

// //D3.js Individual Mean Z-score



//data select from HTML dropdown:

// if you intend on using jquery, here's the easy way
// first, note, that you have to wrap your code in jquery ready call
// i'm doing it here, but you can wrap all your code in it
// and i'd put it all down at the bottom of the page


$(function(){
           
var margin = {top: 10, right:20, bottom: 50, left: 75};                           
var w = 800 - margin.left - margin.right;
var h = 350 - margin.top - margin.bottom;
  
var xScale  = d3.scale.ordinal().domain(d3.range(3)).rangeRoundBands([0, w-120], 0.75);  //from book
var yScale = d3.scale.linear().domain([0.8, 0]).rangeRound([0, 300]); //from book considering my data

//var xAxis = d3.svg.axis().scale(xScale).orient("bottom").tickSize(0).tickFormat("");
var yAxis = d3.svg.axis().scale(yScale).orient("left").ticks(10);

  //create tooltip (from http://bl.ocks.org/Caged/6476579)
var tip = d3.tip()
            .attr('class', 'd3-tip')
            .offset([-10, 0])
            .html(function(d) { return "<strong>" + d.key + " Mean Z-score </strong> <span style='color:red'>" + d3.round(d.values, 2) + "</span>";
            })
 

var svg = d3.select("#mean-zD3").append("svg")
            .attr("width", w + margin.left + margin.right)
            .attr("height", h + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


  svg.call(tip); 

//function for y grid axis lines
function make_y_axis() { return d3.svg.axis().scale(yScale).orient("left").ticks(10)}

var colours = d3.scale.ordinal().domain(["DMN", "ECN", "SN"]).range(["#354e7f","#139e9e","#b81359"]);

 var $inputs = $('#EPI1, #EPI2');
 function on_change(){
   var that = $(this),
      file = that.find('option:selected').val(),
      id = that.attr('id');
      
      if (file) { 
      d3.json(file,function(err,data){
        if (err) {
          console.log(err);
          return;
        }
      
       switch (id) {
         case 'EPI1':
          make_viz(data);
          break;
         case 'EPI2':
          make_viz2(data);
          break;
          default:
          alert(id);
       } //end switch (id) 


      });
    } //end if (file) statement
  } // end function on_change()

$inputs.on('change',on_change); // end $inputs.on('change', function  

 d3.json("js/mean-z/EPI1_101.json", function(error, json) {
  if (error) return console.warn(error);
  data = json;
  make_viz(data);
 });
 
window.setTimeout(function() {
 d3.json("js/mean-z/EPI2_101.json", function(error, json) {
  if (error) return console.warn(error);
  data2 = json;
  make_viz2(data2);
 });
 } ,200)


// add circles for EPI1
function make_viz(data) {
  //alert(circles.toString());
  
  var group = svg.selectAll('g.EPI1');
  if (group.empty())
    group = svg.append('g').classed('EPI1', true);

  var circles = group.selectAll("circle").data(data);
  circles.enter().append("circle");

  //var circle = svg.selectAll("circle").data(data).enter().append("circle");
     
  circles.attr("cx", function(d,i) {return xScale(i);})  //from book how to reference ordinal scale
           .attr("cy", function(d) {return yScale(d.values)}) //.attr("cy", function(d) {return (d.values);})
           .attr("r", "18")
           .attr("fill",function(d) {return colours(d.key);})
           .attr("transform", "translate(0," + (h - xPadding) + ")")
           .attr("transform", "translate(" + dPadding + ",20)")
           .on('mouseover', tip.show)
           .on('mouseout', tip.hide);


// add error bars for circles EPI1
  var lines = group.selectAll("line").data(data);
  //alert(lines[0].length)
  lines.enter().append("line");

  lines.attr("x1", function(d,i) {return xScale(i);})  //x-position of mean
       .attr("y1", function(d) {return yScale(d.values+(d.sd/2));})  //y-position of mean
       .attr("x2", function(d,i) {return xScale(i);}) //x-position of mean same as x1 because vertical line
       .attr("y2", function(d) {return yScale(d.values-(d.sd/2));})   //y position 
       .attr("stroke-width", 2)
       .attr("stroke", function(d) {return colours(d.key);})
       .attr("transform", "translate(0," + (h - xPadding) + ")")
       .attr("transform", "translate(" + dPadding + ",20)");

}; //end make_viz function


// add squares for EPI2
function make_viz2(data2) {

    var group = svg.selectAll('g.EPI2');
  if (group.empty())
    group = svg.append('g').classed('EPI2', true);

  var rects = group.selectAll("rect").data(data2);
  rects.enter().append("rect");


        rects.attr("x", function(d,i) {return xScale(i)+40;})
            .attr("y", function(d) {return yScale(d.values)-16})
            .attr("width", "32")
            .attr("height", "32")
            .attr("fill", function(d) {return colours(d.key);})
           .attr("transform", "translate(0," + (h - xPadding) + ")")
           .attr("transform", "translate(" + dPadding + ",20)")
           .on('mouseover', tip.show)
           .on('mouseout', tip.hide);


      // add error bars for squares EPI2
        var line = group.selectAll("line").data(data2);
        line.enter().append("line");

        line.attr("x1", function(d,i) {return xScale(i)+56;})  //x-position of mean +40px to shift it rightward like the rects (squares)
             .attr("y1", function(d) {return yScale(d.values+(d.sd/2));})  //y-position of mean
             .attr("x2", function(d,i) {return xScale(i)+56;}) //x-position of mean same as x1 because vertical line
             .attr("y2", function(d) {return yScale(d.values-(d.sd/2));})   //y position 
             .attr("stroke-width", 2)
             .attr("stroke", function(d) {return colours(d.key);})
             .attr("transform", "translate(0," + (h - xPadding) + ")")
             .attr("transform", "translate(" + dPadding + ",20)");


};   //end of function make_viz2

  

  svg.append("text")
     .attr("class", "y-label")
     .attr("transform", "rotate(-90)")
     .attr("y", 0-40)
     .attr("x", 0-(h/2+15))
     .style("text-anchor", "middle")
     .text("Mean Correlation");

  svg.append("text")
     .attr("class", "y-label")
     .attr("transform", "rotate(-90)")
     .attr("y", 0-10)
     .attr("x", 0-(h/2+15))
     .style("text-anchor", "middle")
     .text("z-score (+/- sd)");

  var dPadding = 20
  var xPadding = 30;
  var yPadding = 50; 

  //Draw y gridlines
  svg.append("g")
      .attr("class", "grid")
      .attr("transform", "translate(" + yPadding + ",20)").call(yAxis)
      .call(make_y_axis()
        .tickSize(-500, 0, 0)
        .tickFormat(" "));


  //svg.append("g").attr("class", "axis").attr("transform", "translate(50," + (h - xPadding) + ")").call(xAxis);
  svg.append("g").attr("class", "axis").attr("transform", "translate(" + yPadding + ",20)").call(yAxis);
  //on_change();

// function type(d) {
//   d.values = +d.values;
//   return d;
// }

})//end whole $function()





// // //D3.js Group Mean Z-score

function meanzgr() {
    var margin = {top: 10, right:20, bottom: 50, left: 75};                           
    var w = 800 - margin.left - margin.right;
    var h = 350 - margin.top - margin.bottom;
        
    var xScale  = d3.scale.ordinal().domain(d3.range(3)).rangeRoundBands([0, w-120], 0.75);  //from book
    var yScale = d3.scale.linear().domain([0.8, 0]).rangeRound([0, 300]); //from book considering my data

    //var xAxis = d3.svg.axis().scale(xScale).orient("bottom").tickSize(0).tickFormat("");
    var yAxis = d3.svg.axis().scale(yScale).orient("left").ticks(10);


  //create tooltip (from http://bl.ocks.org/Caged/6476579)
var tip = d3.tip()
            .attr('class', 'd3-tip')
            .offset([-10, 0])
            .html(function(d) { return "<strong>" + d.key + " Mean Z-score </strong> <span style='color:red'>" + d3.round(d.values, 2) + "</span>";
            })


    var svg = d3.select("#mean-zGrD3").append("svg")
                  .attr("width", w + margin.left + margin.right)
                  .attr("height", h + margin.top + margin.bottom)
                  .append("g")
                  .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  svg.call(tip); 

  //function for y grid axis lines
  function make_y_axis() { return d3.svg.axis().scale(yScale).orient("left").ticks(10)}

  var color = d3.scale.ordinal().domain(["DMN", "ECN", "SN"]).range(["#354e7f","#139e9e", "#b81359"]);

// Circles EPI1
function makeviz(data) {
        var circles = svg.selectAll("circle").data(data).enter().append("circle");
          
        circles.attr("cx", function(d,i) {return xScale(i);})  //from book how to reference ordinal scale
                 .attr("cy", function(d) {return yScale(d.values)}) //.attr("cy", function(d) {return (d.values);})
                 .attr("r", "18")
                 .attr("fill",function(d) {return color(d.key);})
                 .attr("transform", "translate(0," + (h - xPadding) + ")")
                 .attr("transform", "translate(" + dPadding + ",20)")
                 .on('mouseover', tip.show)
                 .on('mouseout', tip.hide);

        var lines = svg.selectAll("circles").data(data).enter().append("line");

        lines.attr("x1", function(d,i) {return xScale(i);})  //x-position of mean
             .attr("y1", function(d) {return yScale(d.values+(d.sd/2));})  //y-position of mean
             .attr("x2", function(d,i) {return xScale(i);}) //x-position of mean same as x1 because vertical line
             .attr("y2", function(d) {return yScale(d.values-(d.sd/2));})   //y position 
             .attr("stroke-width", 2)
             .attr("stroke", function(d) {return color(d.key);})
             .attr("transform", "translate(0," + (h - xPadding) + ")")
             .attr("transform", "translate(" + dPadding + ",20)");
  };

// Squares EPI2
function makeviz2(data2) {
              var rect = svg.selectAll("rect").data(data2).enter().append("rect");

              rect.attr("x", function(d,i) {return xScale(i)+40;})
                  .attr("y", function(d) {return yScale(d.values)-16})
                  .attr("width", "32")
                  .attr("height", "32")
                  .attr("fill", function(d) {return color(d.key);})
                  .attr("transform", "translate(0," + (h - xPadding) + ")")
                  .attr("transform", "translate(" + dPadding + ",20)")
                  .on('mouseover', tip.show)
                  .on('mouseout', tip.hide);

              var linesb = svg.selectAll("rects").data(data2).enter().append("line");

              linesb.attr("x1", function(d,i) {return xScale(i)+56;})  //x-position of mean +40px to shift it rightward like the rects (squares)
                   .attr("y1", function(d) {return yScale(d.values+(d.sd/2));})  //y-position of mean
                   .attr("x2", function(d,i) {return xScale(i)+56;}) //x-position of mean same as x1 because vertical line
                   .attr("y2", function(d) {return yScale(d.values-(d.sd/2));})   //y position 
                   .attr("stroke-width", 2)
                   .attr("stroke", function(d) {return color(d.key);})
                   .attr("transform", "translate(0," + (h - xPadding) + ")")
                   .attr("transform", "translate(" + dPadding + ",20)");
     };   //end of var EPI2 = d3.json(loadData.json)

        svg.append("text")
           .attr("class", "y-label")
           .attr("transform", "rotate(-90)")
           .attr("y", 0-40)
           .attr("x", 0-(h/2+15))
           .style("text-anchor", "middle")
           .text("Mean Correlation");

        svg.append("text")
           .attr("class", "y-label")
           .attr("transform", "rotate(-90)")
           .attr("y", 0-10)
           .attr("x", 0-(h/2+15))
           .style("text-anchor", "middle")
           .text("z-score (+/- sd)");

        // svg.append("text")
        //    .attr("class", "x-label")
        //    .attr("transform", "translate(50," + (h-xPadding) + ")")
        //    //.style("text-anchor", "middle")
        //    .text("Default Mode Network (DMN)");//, function(d) {return d.colours;});
        //    //.text("Salience Network (SN)", function(d) {return d.colours;})
        //    //.text("Executive Control Network (ECN)", function(d) {return d.colours;});

        var dPadding = 20
        var xPadding = 30;
        var yPadding = 50; 
        


  //Draw y gridlines
  svg.append("g")
      .attr("class", "grid")
      .attr("transform", "translate(" + yPadding + ",20)").call(yAxis)
      .call(make_y_axis()
        .tickSize(-500, 0, 0)
        .tickFormat(" "));
        
//svg.append("g").attr("class", "axis").attr("transform", "translate(50," + (h - xPadding) + ")").call(xAxis);
  svg.append("g").attr("class", "axis").attr("transform", "translate(" + yPadding + ",20)").call(yAxis);


 d3.json("js/mean-z/EPI1_Group.json", function(error, json) {
  if (error) return console.warn(error);
  data = json;
  makeviz(data);
 });
 
window.setTimeout(function() {
 d3.json("js/mean-z/EPI2_Group.json", function(error, json) {
  if (error) return console.warn(error);
  data2 = json;
  makeviz2(data2);
 });
 } ,500)

};
meanzgr(); // Call Group Mean z
 


// // Make Group Network Graphs (adapted from sara.chiartosini http://jsbin.com/omokap/4/edit?html,css,js,output)
function networkGr(slider_num) {
    var w = 355
    var h = 380

  //create tooltip (from http://bl.ocks.org/Caged/6476579)
var tip = d3.tip()
            .attr('class', 'd3-tip')
            .offset([-10, 0])
            .html(function(d) { return "<strong>" + d.NW + ": " + d.id + "</strong>";
            })


    var svg = d3.select("#networkGrD3").append("svg")
                  .attr("width", w )
                  .attr("height", h )
                  .attr('preserveAspectRatio', 'xMinYMin slice') 
                  .append("g");

  svg.call(tip); 

    var color = d3.scale.ordinal().domain(["DMN", "ECN", "SN"]).range(["#354e7f","#139e9e", "#b81359"]);
    var color_weight = d3.scale.linear().domain([0.3, 1]).range(["#f7f7f7", "#969696", "#252525"]);


    var force = self.force = d3.layout.force()  //this looks unusual
      .nodes(graph.nodes)
      .links(graph.links)
      .gravity(0.05).distance(100).charge(-100)
      .size([w,h])
      .start();

    var link = svg.selectAll(".link")
      .data(graph.links)
      .enter().append("line")
      //.filter(function(d) {return d.weight>0.3})
      .attr("class", "link")
      .attr("x1", function(d) {return (d.source.x); })
      .attr("y1", function(d) {return (d.source.y); })
      .attr("x2", function(d) {return (d.target.x); })
      .attr("y2", function(d) {return (d.target.y); })
      .style("stroke-width", function(d) {return (d.weight*5);})
      .style("stroke", function(d) {return color_weight(d.weight)});

    var node_drag = d3.behavior.drag()
      .on("dragstart", dragstart)
      .on("drag", dragmove)
      .on("dragend", dragend);

    var node = svg.selectAll(".node")
      .data(graph.nodes)
      .enter().append("circle")
      .attr("x", function(d) {return d.x;})
      .attr("y", function(d) {return d.y;})
      .attr("class", "node")
      .attr("r", 13)
      .style("fill", function(d) {return color(d.NW);})
      .call(node_drag);
  
    function dragstart(d, i) {
      force.stop(); // stops the force auto positioning before you start dragging
    }

    function dragmove(d, i) {
      d.px += d3.event.dx;
      d.py += d3.event.dy;
      d.x += d3.event.dx;
      d.y += d3.event.dy; 
      tick(); 
    }

    function dragend(d, i) {
      d.fixed = true; // of course set the node to fixed so the force doesn't include the node in its auto positioning stuff
      tick();
      force.resume();
    }
    
    force.on("tick", tick);

    function tick() {
          link.attr("x1", function(d) {return d.source.x; })
          .attr("y1", function(d) {return d.source.y; })
          .attr("x2", function(d) {return d.target.x; })
          .attr("y2", function(d) {return d.target.y; });

node.attr("cx", function(d) {return d.x; })
.attr("cy", function(d) {return d.y; })
.on('mouseover', tip.show)
.on('mouseout', tip.hide);
//.append("title").text(function(d) {return d.id;});
    } // end tick function


var slider_name = "#weight"+slider_num.toString();
var text_name = slider_name+"-value";

  function update(weight) {
    d3.select(text_name).text(weight);
    d3.select(slider_name).property("value",weight);

    //var svg = d3.select("#networkGrD3")[i-1];
    //var link = svg.selectAll(".link");
    link.filter(function(d) {return d.weight>=weight; })
      .style("visibility", function(d) { return "visible"; });
    link.filter(function(d) {return d.weight<weight; })
      .style("visibility", function(d) { return "hidden"; });
  }

  d3.select(slider_name).on("input", function() { update(+this.value); });

// // trying slider function to filter by weight, based on: http://www.d3noob.org/2014/04/using-html-inputs-with-d3js.html
// // when input range changes update weight range
// d3.select("#weight1").on("input", function() {update (+this.value);});
// // initial starting weight threshold
// update(0.3);
// //update the elements
// function update(weight) {

//   //adjust text on range slider
//   d3.select(this).select("weight-value").text(weight);
//   d3.select(this).property("value", weight);

//   //update weight value

//   //svg.selectAll("link")
//       //.data(graph.links)
//       //link.attr("line", weight);
//       //.filter(function(d) {return weight(d.weight);})

// } //end update function
}; //end function networkGr()


 d3.json("js/network/EPI1_Gr_Network.json", function(error, json) {
  if (error) return console.warn(error);
  graph = json;
  networkGr(1);
 });
 
window.setTimeout(function() {
 d3.json("js/network/EPI2_Gr_Network.json", function(error, json) {
  if (error) return console.warn(error);
  graph = json;
  networkGr(2);
 });
 } ,500)




function register_slider(i) {
  var slider_name = "#weight"+i.toString();
  var text_name = "#weight"+i.toString()+"-value";

  function update(weight) {
    d3.select(text_name).text(weight);
    d3.select(slider_name).property("value",weight);

    //var svg = d3.select("#networkGrD3")[i-1];
    //var link = svg.selectAll(".link");
    link.filter(function(d) {return d.weight>weight; });
  }

  d3.select(slider_name).on("input", function() { update(+this.value); });
}
//register_slider(1);
//register_slider(2);



// // // Make EPI1 Cluster Network Graphs
function networkClust() {
    var w = 355
    var h = 380

  //create tooltip (from http://bl.ocks.org/Caged/6476579)
var tip = d3.tip()
            .attr('class', 'd3-tip')
            .offset([-10, 0])
            .html(function(d) { return "<strong>" + d.NW + ":" + d.id + "</strong>";
            })

    var svg = d3.select("#networkClustD3").append("svg")
                  .attr("width", w )
                  .attr("height", h )
                  .attr('preserveAspectRatio', 'xMinYMin slice') 
                  .append("g");

  svg.call(tip);


    var color = d3.scale.ordinal().domain(["DMN", "ECN", "SN"]).range(["#354e7f","#139e9e","#b81359"]);
    //var color_weight = d3.scale.linear().domain([-0.5, 0.8]).range(["#FFFFFF","#000000"])
    var color_weight = d3.scale.linear().domain([0.3, 1]).range(["#f7f7f7", "#969696", "#252525"])
    //var color_weight = d3.scale.linear().domain([0.3, 1]).range(["#f7f7f7", "#252525"])


    var force = self.force = d3.layout.force()  //this looks unusual
      .nodes(graph.nodes)
      .links(graph.links)
      .gravity(0.05).distance(100).charge(-100)
      .size([w,h])
      .start();

    var link = svg.selectAll(".link")
      .data(graph.links)
      .enter().append("line")
      //.filter(function(d) {return d.weight>0.3})
      .attr("class", "link")
      .attr("x1", function(d) {return (d.source.x); })
      .attr("y1", function(d) {return (d.source.y); })
      .attr("x2", function(d) {return (d.target.x); })
      .attr("y2", function(d) {return (d.target.y); })
      .style("stroke-width", function(d) {return (d.weight*5);})
      .style("stroke", function(d) {return color_weight(d.weight)});

    var node_drag = d3.behavior.drag()
      .on("dragstart", dragstart)
      .on("drag", dragmove)
      .on("dragend", dragend);

    var node = svg.selectAll(".node")
      .data(graph.nodes)
      .enter().append("circle")
      .attr("x", function(d) {return d.x;})
      .attr("y", function(d) {return d.y;})
      .attr("class", "node")
      .attr("r", 13)
      .style("fill", function(d) {return color(d.NW);})
      .call(node_drag);
  
    function dragstart(d, i) {
      force.stop(); // stops the force auto positioning before you start dragging
    }

    function dragmove(d, i) {
      d.px += d3.event.dx;
      d.py += d3.event.dy;
      d.x += d3.event.dx;
      d.y += d3.event.dy; 
      tick(); 
    }

    function dragend(d, i) {
      d.fixed = true; // of course set the node to fixed so the force doesn't include the node in its auto positioning stuff
      tick();
      force.resume();
    }
    
    force.on("tick", tick);

    function tick() {
          link.attr("x1", function(d) {return d.source.x; })
          .attr("y1", function(d) {return d.source.y; })
          .attr("x2", function(d) {return d.target.x; })
          .attr("y2", function(d) {return d.target.y; });

node.attr("cx", function(d) {return d.x; })
.attr("cy", function(d) {return d.y; })
.on('mouseover', tip.show)
.on('mouseout', tip.hide);
//.append("title").text(function(d) {return d.id;});
    } // end tick function
}; //end function networkClust()


 d3.json("js/network/EPI1_Clust0_Network.json", function(error, json) {
  if (error) return console.warn(error);
  graph = json;
  networkClust();
 });
 
window.setTimeout(function() {
 d3.json("js/network/EPI1_Clust1_Network.json", function(error, json) {
  if (error) return console.warn(error);
  graph = json;
  networkClust();
 }); 

} ,500)



// Adjacency Matrix for Clusters (adapted from Bostock)

function make_adjMat() {
    var margin = {top: 100, right: 60, bottom: 30, left: 60},
        width = 255,
        height = 255;

    var x = d3.scale.ordinal().rangeBands([0, width]),
        //z = d3.scale.linear().domain([0, 1]).clamp(true),
        //c = d3.scale.category10().domain(d3.range(1)),
        color = d3.scale.ordinal().domain(["DMN", "ECN", "SN"]).range(["#354e7f","#139e9e","#b81359"]),
        //color_weight = d3.scale.quantile().domain([0.01, 0.03, 0.06, 0.9, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6]).range(["#006837", "#1a9850", "#66bd63", "#a6d96a", "#d9ef8b", "#ffffbf", "#fee08b", "#fdae61", "#f46d43", "#d73027", "#a50026"]);
        color_weight = d3.scale.quantile().domain([0.01, 0.03, 0.06, 0.9, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6]).range(["#276419", "#4d9221", "#7fbc41", "#b8e186", "#e6f5d0", "#f7f7f7", "#fde0ef", "#f1b6da", "#de77ae", "#c51b7d", "#8e0152"]);  //color blind safe. Both from Color Brewer

  //create tooltip (from http://bl.ocks.org/Caged/6476579)
var tip = d3.tip()
            .attr('class', 'd3-tip')
            .offset([-10, 0])
            .html(function(d) { return "<strong>"+  d3.round(d.z, 2) + "</span>";
            })

    var svg = d3.select("#corrmatClustD3").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        //.style("margin-left", -margin.left + "px")
      .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  svg.call(tip);

      var matrix = [],
          nodes = data.nodes,
          n = nodes.length;

      // Compute index per node.
      nodes.forEach(function(node, i) {
        node.index = i; 
        //node.weight = 0; //pretty sure this does nothing in this script
        matrix[i] = d3.range(n).map(function(j) { return {x: j, y: i, z: 0}; });
      });

      // Convert links to matrix; count character occurrences.
      data.links.forEach(function(link) {
        matrix[link.source][link.target].z += link.weight;
        matrix[link.target][link.source].z += link.weight;
        matrix[link.source][link.source].z += link.weight;
        matrix[link.target][link.target].z += link.weight;
        //nodes[link.source].weight += link.weight;
        //nodes[link.target].weight += link.weight;
      });

      // Precompute the orders.
      var orders = {
        //id: d3.range(n).sort(function(a, b) { return d3.ascending(nodes[a].id, nodes[b].id); }),
         //NW: d3.range(n).sort(function(a, b) { return nodes[b].NW - nodes[a].NW; })
        //NW: d3.range(n).sort(function(a, b) { return d3.ascending(nodes[a].NW, nodes[b].NW); }),
        //weight: d3.range(n).sort(function(a, b) {return nodes[b].weight - nodes[a].weight;}),
        idNW_order: d3.range(n).sort(function(a, b) { return d3.ascending(nodes[a].order, nodes[b].order); })
        //weight: d3.range(n).sort(function(a, b) {return link[b].weight - link[a].weight;}),

      };

      // The default sort order.
      x.domain(orders.idNW_order); //how to make it sort order NW first, and then further sort by alphabet ("id") (ignoring "l" and "r")

      svg.append("rect")
          .attr("class", "background")
          .attr("width", width)
          .attr("height", height);

      var row = svg.selectAll(".row")
          .data(matrix)
        .enter().append("g")
          .attr("class", "row")
          .attr("transform", function(d, i) { return "translate(0," + x(i) + ")"; })
          .each(row);

      row.append("line")
          .attr("x2", width);
    
      row.append("text")
          .attr("x", -6)
          .attr("y", x.rangeBand() / 2)
          .attr("dy", ".32em")
          .attr("text-anchor", "end")
          .text(function(d, i) { return nodes[i].id; })
          .style("fill", function(d, i) {return color(nodes[i].NW);});

      var column = svg.selectAll(".column")
          .data(matrix)
        .enter().append("g")
          .attr("class", "column")
          .attr("transform", function(d, i) { return "translate(" + x(i) + ")rotate(-90)"; });

      column.append("line")
          .attr("x1", -width);

      column.append("text")
          .attr("x", 6)
          .attr("y", x.rangeBand() / 2)
          .attr("dy", ".32em")
          .attr("text-anchor", "start")
          .text(function(d, i) { return nodes[i].id; })
          .style("fill", function(d, i) {return color(nodes[i].NW);});
      
      
      function row(row) {
        var cell = d3.select(this).selectAll(".cell")
            .data(row.filter(function(d) { return d.z; }))
            .enter().append("rect")
            .attr("class", "cell")
            .attr("z", function(d) { return d.z; })
            .attr("x", function(d) { return x(d.x); })
            .attr("width", x.rangeBand())
            .attr("height", x.rangeBand())
            .style("fill", function(d) {return color_weight(d.z); }) //right now THIS is mapping to weight value
            //.style("fill", function(d) { return nodes[d.x].weight == nodes[d.y].weight ? c(nodes[d.x].weight) : null; })  //was by "group" (categorical) Changed "c" to linear
            .on("mouseover", mouseover)
            .on("mouseout", mouseout);
            //.on('mouseover', tip.show)
            //.on('mouseout', tip.hide);
      }

      function mouseover(p) {
        var gr = d3.selectAll(".row text");
   //     alert(gr[0].length);
        tip.show(p);
        svg.selectAll(".row text").classed("active", function(d, i) { return i == p.x; });
        svg.selectAll(".column text").classed("active", function(d, i) { return i == p.x;
        });
      }

      function mouseout() {
        tip.hide();
        svg.selectAll("text").classed("active", false);
      }

      // d3.select("#order").on("change", function() {
      //   clearTimeout(timeout);
      //   order(this.value);
      // });

      // function order(value) {
      //   x.domain(orders[value]);

      //   var t = svg.transition().duration(2500);

      //   t.selectAll(".row")
      //       .delay(function(d, i) { return x(i) * 4; })
      //       .attr("transform", function(d, i) { return "translate(0," + x(i) + ")"; })
      //     .selectAll(".cell")
      //       .delay(function(d) { return x(d.x) * 4; })
      //       .attr("x", function(d) { return x(d.x); });

      //   t.selectAll(".column")
      //       .delay(function(d, i) { return x(i) * 4; })
      //       .attr("transform", function(d, i) { return "translate(" + x(i) + ")rotate(-90)"; });
      // }

      // var timeout = setTimeout(function() {
      //   order("order");
      //   d3.select("#order").property("selectedIndex", 2).node().focus();
      // }, 5000);

};  // end make_adjMat() function

//make_adjMat();

  d3.json("js/corrmat/EPI1_Clust0_corrmat.json", function(error, json) {
   if (error) return console.warn(error);
   data = json;
   make_adjMat();
  });
 
window.setTimeout(function() {
 d3.json("js/corrmat/EPI1_Clust1_corrmat.json", function(error, json) {
  if (error) return console.warn(error);
  data = json;
  make_adjMat();
 }); 

} ,500)

  </script>
</body>
</html> 